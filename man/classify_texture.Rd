% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/texture.R
\name{classify_texture}
\alias{classify_texture}
\title{Classify USDA soil texture from particle-size fractions}
\source{
Thresholds for texture classification are based on the USDA NRCS Soil
Texture Calculator
\url{https://www.nrcs.usda.gov/resources/education-and-teaching-materials/soil-texture-calculator}.
}
\usage{
classify_texture(df)
}
\arguments{
\item{df}{A data frame containing the columns \code{sand_percent},
\code{silt_percent}, and \code{clay_percent}.}
}
\value{
A data frame with a \code{texture} column containing USDA soil
texture classes. Soil fractions are rounded to whole numbers.
}
\description{
Validates soil particle-size fractions (sand, silt, and clay), completes
missing values when possible, and assigns a USDA soil texture class.
}
\details{
\code{classify_texture()} applies the following validation rules and
assumptions:

\itemize{
\item Each row must contain values for at least two of
\code{sand_percent}, \code{silt_percent}, and \code{clay_percent}.
Rows with fewer than two provided fractions must be corrected before
texture classification can proceed.

\item When exactly one fraction is missing, it is calculated as
\code{100 - (sum of the other two)}.

\item All fraction values must fall within the range 0â€“100, and fully
specified rows must sum to exactly 100.

\item Rows with all three fractions missing are assumed to represent
samples where soil texture was not measured. These rows are retained
and returned with a missing texture class.
}
}
\examples{

# Three samples classified without error

df <- data.frame(
  sand_percent = c(20, 45, 75),
  silt_percent = c(65, 35, 15),
  clay_percent = c(15, 20, 10)
)

classify_texture(df)

# Error when a sample has insufficient data
# One row is missing two soil fractions

df <- data.frame(
  sand_percent = c(40, NA, 65),
  silt_percent = c(40, 55, 5),
  clay_percent = c(20, NA, 30)
)

try(classify_texture(df))

# Error when any fraction is outside the allowable range (0-100)

df <- data.frame(
  sand_percent = c(40, 0, 65),
  silt_percent = c(40, 55, 5),
  clay_percent = c(20, 110, 30)
)

try(classify_texture(df))

# Error when fractions do not sum to 100

df <- data.frame(
  sand_percent = c(40, 0, 90),
  silt_percent = c(40, 55, 5),
  clay_percent = c(20, 45, 30)
)

try(classify_texture(df))

# Warn when one fraction is missing
# The missing fraction is calculated as 100 minus the other two

df <- data.frame(
  sand_percent = c(NA, 60, 25),
  silt_percent = c(45, 10, 40),
  clay_percent = c(50, 30, 35)
)

classify_texture(df)

# Warn when soil texture was not measured
# Rows with all fractions missing return a blank texture class

  df <- data.frame(
   sand_percent = c(NA, NA, 30),
   silt_percent = c(NA, NA, 30),
   clay_percent = c(NA, NA, 40)
 )

 classify_texture(df)

}
